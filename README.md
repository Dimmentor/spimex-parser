<h2>Синхронный парсер на FastAPI</h2>

<h3>скачивает бюллетени по итогам торгов с сайта биржи (https://spimex.com/markets/oil_products/trades/results/) </h3>

<h3>Краткий гайд по установке:</h3>

1)  Клонировать репозиторий

```sh
  git clone https://github.com/Dimmentor/spimex-parser.git
```

2) Установить зависимости:

```sh
  poetry install
```

3) С docker-compose заморачиваться не стал(только вникаю в poetry), поэтому придется прописать переменные окружения для БД в файле config.py

4) Применить миграцию

```sh
  poetry alembic upgrade head
```

5) Запуск приложения

```sh
  poetry uvicorn app.main:app --reload
```

<h3>Для удобства реализованы 2 эндпоинта, можно использовать Swagger(http://127.0.0.1:8000/docs) или Postman</h3> 

1) Запуск скачивания отчётов(по умолчанию с 01.01.2023 по текущую дату)

```sh
POST /download-reports/
```

* Либо выбрать дату вручную 
```sh
POST /download-reports/?start_date=2023-01-01&end_date=2025-07-11
```

2) Запуск обработки всех скачанных файлов и записи в БД
```sh
POST /process-reports/
```

<h3>Итоговые метрики:</h3>

* 127410 записей с 01.01.2023 по 13.07.2025(621 отчёт)

* Скачивание всех отчётов выполняется за ~25 минут 

* Обработка и загрузка данных в БД за ~4 минуты

TODO: использовать асинхронность для оптимизации.
